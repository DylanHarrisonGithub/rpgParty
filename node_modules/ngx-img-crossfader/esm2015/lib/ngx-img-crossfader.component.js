/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, ViewChild } from '@angular/core';
export class NgxImgCrossfaderComponent {
    constructor() {
        this.initDelayMS = 0;
        this.idleTimeMS = 5000;
        this.transitionTimeMS = 1000;
        this.autoAdvance = true;
        this.imageSources = [];
        this.backgroundColor = 'rgba(0,0,0,1.0)';
        this.img1Num = 0;
        this.img2Num = 1;
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.div = (/** @type {?} */ (this.bkgCrossfaderDiv.nativeElement));
        this.img1 = (/** @type {?} */ (this.bkgCrossfaderImg1.nativeElement));
        this.img2 = (/** @type {?} */ (this.bkgCrossfaderImg2.nativeElement));
        this.div.style.backgroundColor = this.backgroundColor;
        this.img1.style.transitionDuration = this.transitionTimeMS.toString() + 'ms';
        this.img1.style.webkitTransitionDuration = this.transitionTimeMS.toString() + 'ms';
        this.img2.style.transitionDuration = this.transitionTimeMS.toString() + 'ms';
        this.img2.style.webkitTransitionDuration = this.transitionTimeMS.toString() + 'ms';
        setTimeout((/**
         * @return {?}
         */
        () => {
            this.idle();
        }), this.initDelayMS);
    }
    /**
     * @private
     * @return {?}
     */
    idle() {
        setTimeout((/**
         * @return {?}
         */
        () => {
            if (this.autoAdvance) {
                this.transition();
            }
            else {
                this.idle();
            }
        }), this.idleTimeMS);
    }
    /**
     * @private
     * @return {?}
     */
    transition() {
        if (this.imageSources.length > 1) {
            if (this.img1.classList.contains('ngx-img-crossfader-transparent')) {
                this.img1Num = (this.img2Num + 1) % this.imageSources.length;
            }
            else {
                this.img2Num = (this.img1Num + 1) % this.imageSources.length;
            }
            this.img1.style.transitionDuration = this.transitionTimeMS.toString() + 'ms';
            this.img1.style.webkitTransitionDuration = this.transitionTimeMS.toString() + 'ms';
            this.img2.style.transitionDuration = this.transitionTimeMS.toString() + 'ms';
            this.img2.style.webkitTransitionDuration = this.transitionTimeMS.toString() + 'ms';
            this.img1.classList.toggle('ngx-img-crossfader-transparent');
            this.img2.classList.toggle('ngx-img-crossfader-transparent');
            setTimeout((/**
             * @return {?}
             */
            () => {
                this.idle();
            }), this.transitionTimeMS);
        }
    }
    /**
     * @return {?}
     */
    stepForward() {
        if (this.imageSources.length > 1) {
            if (this.img1.classList.contains('ngx-img-crossfader-transparent')) {
                this.img1Num = (this.img2Num + 1) % this.imageSources.length;
            }
            else {
                this.img2Num = (this.img1Num + 1) % this.imageSources.length;
            }
            this.img1.style.transitionDuration = this.transitionTimeMS.toString() + 'ms';
            this.img1.style.webkitTransitionDuration = this.transitionTimeMS.toString() + 'ms';
            this.img2.style.transitionDuration = this.transitionTimeMS.toString() + 'ms';
            this.img2.style.webkitTransitionDuration = this.transitionTimeMS.toString() + 'ms';
            this.img1.classList.toggle('ngx-img-crossfader-transparent');
            this.img2.classList.toggle('ngx-img-crossfader-transparent');
        }
    }
    /**
     * @return {?}
     */
    stepBackward() {
        if (this.imageSources.length > 1) {
            if (this.img1.classList.contains('ngx-img-crossfader-transparent')) {
                this.img1Num = (this.img2Num - 1 + this.imageSources.length) % this.imageSources.length;
            }
            else {
                this.img2Num = (this.img1Num - 1 + this.imageSources.length) % this.imageSources.length;
            }
            this.img1.style.transitionDuration = this.transitionTimeMS.toString() + 'ms';
            this.img1.style.webkitTransitionDuration = this.transitionTimeMS.toString() + 'ms';
            this.img2.style.transitionDuration = this.transitionTimeMS.toString() + 'ms';
            this.img2.style.webkitTransitionDuration = this.transitionTimeMS.toString() + 'ms';
            this.img1.classList.toggle('ngx-img-crossfader-transparent');
            this.img2.classList.toggle('ngx-img-crossfader-transparent');
        }
    }
    /**
     * @param {?} imgNum
     * @return {?}
     */
    getSrc(imgNum) {
        if (imgNum < this.imageSources.length) {
            return this.imageSources[imgNum];
        }
        else {
            if (this.imageSources.length) {
                return this.imageSources[0];
            }
            else {
                return null;
            }
        }
    }
    /**
     * @return {?}
     */
    getImg1Num() { return this.img1Num; }
    /**
     * @return {?}
     */
    getImg2Num() { return this.img2Num; }
}
NgxImgCrossfaderComponent.decorators = [
    { type: Component, args: [{
                selector: 'ngx-img-crossfader',
                template: `
    <div class="ngx-img-crossfader-div" #bkgCrossfaderDiv>
      <img class="ngx-img-crossfader-img" [src]="getSrc(getImg1Num())" #bkgCrossfaderImg1>
      <img class="ngx-img-crossfader-img ngx-img-crossfader-transparent" [src]="getSrc(getImg2Num())" #bkgCrossfaderImg2>
    </div>
  `
            }] }
];
/** @nocollapse */
NgxImgCrossfaderComponent.ctorParameters = () => [];
NgxImgCrossfaderComponent.propDecorators = {
    initDelayMS: [{ type: Input }],
    idleTimeMS: [{ type: Input }],
    transitionTimeMS: [{ type: Input }],
    autoAdvance: [{ type: Input }],
    imageSources: [{ type: Input }],
    backgroundColor: [{ type: Input }],
    bkgCrossfaderDiv: [{ type: ViewChild, args: ['bkgCrossfaderDiv',] }],
    bkgCrossfaderImg1: [{ type: ViewChild, args: ['bkgCrossfaderImg1',] }],
    bkgCrossfaderImg2: [{ type: ViewChild, args: ['bkgCrossfaderImg2',] }]
};
if (false) {
    /** @type {?} */
    NgxImgCrossfaderComponent.prototype.initDelayMS;
    /** @type {?} */
    NgxImgCrossfaderComponent.prototype.idleTimeMS;
    /** @type {?} */
    NgxImgCrossfaderComponent.prototype.transitionTimeMS;
    /** @type {?} */
    NgxImgCrossfaderComponent.prototype.autoAdvance;
    /** @type {?} */
    NgxImgCrossfaderComponent.prototype.imageSources;
    /** @type {?} */
    NgxImgCrossfaderComponent.prototype.backgroundColor;
    /**
     * @type {?}
     * @private
     */
    NgxImgCrossfaderComponent.prototype.bkgCrossfaderDiv;
    /**
     * @type {?}
     * @private
     */
    NgxImgCrossfaderComponent.prototype.bkgCrossfaderImg1;
    /**
     * @type {?}
     * @private
     */
    NgxImgCrossfaderComponent.prototype.bkgCrossfaderImg2;
    /**
     * @type {?}
     * @private
     */
    NgxImgCrossfaderComponent.prototype.div;
    /**
     * @type {?}
     * @private
     */
    NgxImgCrossfaderComponent.prototype.img1;
    /**
     * @type {?}
     * @private
     */
    NgxImgCrossfaderComponent.prototype.img2;
    /**
     * @type {?}
     * @private
     */
    NgxImgCrossfaderComponent.prototype.img1Num;
    /**
     * @type {?}
     * @private
     */
    NgxImgCrossfaderComponent.prototype.img2Num;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LWltZy1jcm9zc2ZhZGVyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL25neC1pbWctY3Jvc3NmYWRlci8iLCJzb3VyY2VzIjpbImxpYi9uZ3gtaW1nLWNyb3NzZmFkZXIuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFVLEtBQUssRUFBRSxTQUFTLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFZcEUsTUFBTSxPQUFPLHlCQUF5QjtJQW1CcEM7UUFqQlMsZ0JBQVcsR0FBVyxDQUFDLENBQUM7UUFDeEIsZUFBVSxHQUFXLElBQUksQ0FBQztRQUMxQixxQkFBZ0IsR0FBVyxJQUFJLENBQUM7UUFDaEMsZ0JBQVcsR0FBWSxJQUFJLENBQUM7UUFDNUIsaUJBQVksR0FBa0IsRUFBRSxDQUFDO1FBQ2pDLG9CQUFlLEdBQVcsaUJBQWlCLENBQUM7UUFTN0MsWUFBTyxHQUFXLENBQUMsQ0FBQztRQUNwQixZQUFPLEdBQVcsQ0FBQyxDQUFDO0lBRVosQ0FBQzs7OztJQUVqQixRQUFRO1FBQ04sSUFBSSxDQUFDLEdBQUcsR0FBRyxtQkFBZ0IsSUFBSSxDQUFDLGdCQUFnQixDQUFDLGFBQWEsRUFBQSxDQUFDO1FBQy9ELElBQUksQ0FBQyxJQUFJLEdBQUcsbUJBQWtCLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxhQUFhLEVBQUEsQ0FBQztRQUNuRSxJQUFJLENBQUMsSUFBSSxHQUFHLG1CQUFrQixJQUFJLENBQUMsaUJBQWlCLENBQUMsYUFBYSxFQUFBLENBQUM7UUFFbkUsSUFBSSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsZUFBZSxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUM7UUFDdEQsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsa0JBQWtCLEdBQUcsSUFBSSxDQUFDLGdCQUFnQixDQUFDLFFBQVEsRUFBRSxHQUFFLElBQUksQ0FBQztRQUM1RSxJQUFJLENBQUMsSUFBSSxDQUFDLEtB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VUFBVSxLQUFZLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQSxDQUFBLENBQUM7Ozs7SUFDMUMsVUFBVSxLQUFZLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQSxDQUFBLENBQUM7OztZQXhIM0MsU0FBUyxTQUFDO2dCQUNULFFBQVEsRUFBRSxvQkFBb0I7Z0JBQzlCLFFBQVEsRUFBRTs7Ozs7R0FLVDthQUVGOzs7OzswQkFHRSxLQUFLO3lCQUNMLEtBQUs7K0JBQ0wsS0FBSzswQkFDTCxLQUFLOzJCQUNMLEtBQUs7OEJBQ0wsS0FBSzsrQkFFTCxTQUFTLFNBQUMsa0JBQWtCO2dDQUM1QixTQUFTLFNBQUMsbUJBQW1CO2dDQUM3QixTQUFTLFNBQUMsbUJBQW1COzs7O0lBVDlCLGdEQUFpQzs7SUFDakMsK0NBQW1DOztJQUNuQyxxREFBeUM7O0lBQ3pDLGdEQUFxQzs7SUFDckMsaURBQTBDOztJQUMxQyxvREFBcUQ7Ozs7O0lBRXJELHFEQUF3RDs7Ozs7SUFDeEQsc0RBQTBEOzs7OztJQUMxRCxzREFBMEQ7Ozs7O0lBRTFELHdDQUE0Qjs7Ozs7SUFDNUIseUNBQStCOzs7OztJQUMvQix5Q0FBK0I7Ozs7O0lBQy9CLDRDQUE0Qjs7Ozs7SUFDNUIsNENBQTRCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQsIElucHV0LCBWaWV3Q2hpbGQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAnbmd4LWltZy1jcm9zc2ZhZGVyJyxcclxuICB0ZW1wbGF0ZTogYFxyXG4gICAgPGRpdiBjbGFzcz1cIm5neC1pbWctY3Jvc3NmYWRlci1kaXZcIiAjYmtnQ3Jvc3NmYWRlckRpdj5cclxuICAgICAgPGltZyBjbGFzcz1cIm5neC1pbWctY3Jvc3NmYWRlci1pbWdcIiBbc3JjXT1cImdldFNyYyhnZXRJbWcxTnVtKCkpXCIgI2JrZ0Nyb3NzZmFkZXJJbWcxPlxyXG4gICAgICA8aW1nIGNsYXNzPVwibmd4LWltZy1jcm9zc2ZhZGVyLWltZyBuZ3gtaW1nLWNyb3NzZmFkZXItdHJhbnNwYXJlbnRcIiBbc3JjXT1cImdldFNyYyhnZXRJbWcyTnVtKCkpXCIgI2JrZ0Nyb3NzZmFkZXJJbWcyPlxyXG4gICAgPC9kaXY+XHJcbiAgYCxcclxuICBzdHlsZXM6IFtdXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBOZ3hJbWdDcm9zc2ZhZGVyQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcclxuXHJcbiAgQElucHV0KCkgaW5pdERlbGF5TVM6IG51bWJlciA9IDA7XHJcbiAgQElucHV0KCkgaWRsZVRpbWVNUzogbnVtYmVyID0gNTAwMDtcclxuICBASW5wdXQoKSB0cmFuc2l0aW9uVGltZU1TOiBudW1iZXIgPSAxMDAwO1xyXG4gIEBJbnB1dCgpIGF1dG9BZHZhbmNlOiBib29sZWFuID0gdHJ1ZTtcclxuICBASW5wdXQoKSBpbWFnZVNvdXJjZXM6IEFycmF5PHN0cmluZz4gPSBbXTtcclxuICBASW5wdXQoKSBiYWNrZ3JvdW5kQ29sb3I6IHN0cmluZyA9ICdyZ2JhKDAsMCwwLDEuMCknO1xyXG4gIFxyXG4gIEBWaWV3Q2hpbGQoJ2JrZ0Nyb3NzZmFkZXJEaXYnKSBwcml2YXRlIGJrZ0Nyb3NzZmFkZXJEaXY7XHJcbiAgQFZpZXdDaGlsZCgnYmtnQ3Jvc3NmYWRlckltZzEnKSBwcml2YXRlIGJrZ0Nyb3NzZmFkZXJJbWcxO1xyXG4gIEBWaWV3Q2hpbGQoJ2JrZ0Nyb3NzZmFkZXJJbWcyJykgcHJpdmF0ZSBia2dDcm9zc2ZhZGVySW1nMjtcclxuXHJcbiAgcHJpdmF0ZSBkaXY6IEhUTUxEaXZFbGVtZW50O1xyXG4gIHByaXZhdGUgaW1nMTogSFRNTEltYWdlRWxlbWVudDtcclxuICBwcml2YXRlIGltZzI6IEhUTUxJbWFnZUVsZW1lbnQ7XHJcbiAgcHJpdmF0ZSBpbWcxTnVtOiBudW1iZXIgPSAwO1xyXG4gIHByaXZhdGUgaW1nMk51bTogbnVtYmVyID0gMTtcclxuXHJcbiAgY29uc3RydWN0b3IoKSB7IH1cclxuXHJcbiAgbmdPbkluaXQoKSB7XHJcbiAgICB0aGlzLmRpdiA9IDxIVE1MRGl2RWxlbWVudD50aGlzLmJrZ0Nyb3NzZmFkZXJEaXYubmF0aXZlRWxlbWVudDtcclxuICAgIHRoaXMuaW1nMSA9IDxIVE1MSW1hZ2VFbGVtZW50PnRoaXMuYmtnQ3Jvc3NmYWRlckltZzEubmF0aXZlRWxlbWVudDtcclxuICAgIHRoaXMuaW1nMiA9IDxIVE1MSW1hZ2VFbGVtZW50PnRoaXMuYmtnQ3Jvc3NmYWRlckltZzIubmF0aXZlRWxlbWVudDtcclxuXHJcbiAgICB0aGlzLmRpdi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSB0aGlzLmJhY2tncm91bmRDb2xvcjtcclxuICAgIHRoaXMuaW1nMS5zdHlsZS50cmFuc2l0aW9uRHVyYXRpb24gPSB0aGlzLnRyYW5zaXRpb25UaW1lTVMudG9TdHJpbmcoKSArJ21zJztcclxuICAgIHRoaXMuaW1nMS5zdHlsZS53ZWJraXRUcmFuc2l0aW9uRHVyYXRpb24gPSB0aGlzLnRyYW5zaXRpb25UaW1lTVMudG9TdHJpbmcoKSArJ21zJztcclxuICAgIHRoaXMuaW1nMi5zdHlsZS50cmFuc2l0aW9uRHVyYXRpb24gPSB0aGlzLnRyYW5zaXRpb25UaW1lTVMudG9TdHJpbmcoKSArJ21zJztcclxuICAgIHRoaXMuaW1nMi5zdHlsZS53ZWJraXRUcmFuc2l0aW9uRHVyYXRpb24gPSB0aGlzLnRyYW5zaXRpb25UaW1lTVMudG9TdHJpbmcoKSArJ21zJzsgICAgXHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgdGhpcy5pZGxlKCk7XHJcbiAgICB9LCB0aGlzLmluaXREZWxheU1TKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgaWRsZSgpOiB2b2lkIHtcclxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICBpZiAodGhpcy5hdXRvQWR2YW5jZSkge1xyXG4gICAgICAgIHRoaXMudHJhbnNpdGlvbigpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMuaWRsZSgpO1xyXG4gICAgICB9XHJcbiAgICB9LCB0aGlzLmlkbGVUaW1lTVMpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSB0cmFuc2l0aW9uKCk6IHZvaWQge1xyXG4gICAgaWYgKHRoaXMuaW1hZ2VTb3VyY2VzLmxlbmd0aCA+IDEpIHtcclxuICAgICAgaWYgKHRoaXMuaW1nMS5jbGFzc0xpc3QuY29udGFpbnMoJ25neC1pbWctY3Jvc3NmYWRlci10cmFuc3BhcmVudCcpKSB7XHJcbiAgICAgICAgdGhpcy5pbWcxTnVtID0gKHRoaXMuaW1nMk51bSArIDEpICUgdGhpcy5pbWFnZVNvdXJjZXMubGVuZ3RoO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMuaW1nMk51bSA9ICh0aGlzLmltZzFOdW0gKyAxKSAlIHRoaXMuaW1hZ2VTb3VyY2VzLmxlbmd0aDtcclxuICAgICAgfSAgICAgIFxyXG4gICAgICB0aGlzLmltZzEuc3R5bGUudHJhbnNpdGlvbkR1cmF0aW9uID0gdGhpcy50cmFuc2l0aW9uVGltZU1TLnRvU3RyaW5nKCkgKydtcyc7XHJcbiAgICAgIHRoaXMuaW1nMS5zdHlsZS53ZWJraXRUcmFuc2l0aW9uRHVyYXRpb24gPSB0aGlzLnRyYW5zaXRpb25UaW1lTVMudG9TdHJpbmcoKSArJ21zJztcclxuICAgICAgdGhpcy5pbWcyLnN0eWxlLnRyYW5zaXRpb25EdXJhdGlvbiA9IHRoaXMudHJhbnNpdGlvblRpbWVNUy50b1N0cmluZygpICsnbXMnO1xyXG4gICAgICB0aGlzLmltZzIuc3R5bGUud2Via2l0VHJhbnNpdGlvbkR1cmF0aW9uID0gdGhpcy50cmFuc2l0aW9uVGltZU1TLnRvU3RyaW5nKCkgKydtcyc7XHJcbiAgICAgIHRoaXMuaW1nMS5jbGFzc0xpc3QudG9nZ2xlKCduZ3gtaW1nLWNyb3NzZmFkZXItdHJhbnNwYXJlbnQnKTtcclxuICAgICAgdGhpcy5pbWcyLmNsYXNzTGlzdC50b2dnbGUoJ25neC1pbWctY3Jvc3NmYWRlci10cmFuc3BhcmVudCcpOyAgICAgIFxyXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICB0aGlzLmlkbGUoKTtcclxuICAgICAgfSwgdGhpcy50cmFuc2l0aW9uVGltZU1TKTsgICAgIFxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc3RlcEZvcndhcmQoKSB7XHJcbiAgICBpZiAodGhpcy5pbWFnZVNvdXJjZXMubGVuZ3RoID4gMSkge1xyXG4gICAgICBpZiAodGhpcy5pbWcxLmNsYXNzTGlzdC5jb250YWlucygnbmd4LWltZy1jcm9zc2ZhZGVyLXRyYW5zcGFyZW50JykpIHtcclxuICAgICAgICB0aGlzLmltZzFOdW0gPSAodGhpcy5pbWcyTnVtICsgMSkgJSB0aGlzLmltYWdlU291cmNlcy5sZW5ndGg7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5pbWcyTnVtID0gKHRoaXMuaW1nMU51bSArIDEpICUgdGhpcy5pbWFnZVNvdXJjZXMubGVuZ3RoO1xyXG4gICAgICB9ICAgICAgXHJcbiAgICAgIHRoaXMuaW1nMS5zdHlsZS50cmFuc2l0aW9uRHVyYXRpb24gPSB0aGlzLnRyYW5zaXRpb25UaW1lTVMudG9TdHJpbmcoKSArJ21zJztcclxuICAgICAgdGhpcy5pbWcxLnN0eWxlLndlYmtpdFRyYW5zaXRpb25EdXJhdGlvbiA9IHRoaXMudHJhbnNpdGlvblRpbWVNUy50b1N0cmluZygpICsnbXMnO1xyXG4gICAgICB0aGlzLmltZzIuc3R5bGUudHJhbnNpdGlvbkR1cmF0aW9uID0gdGhpcy50cmFuc2l0aW9uVGltZU1TLnRvU3RyaW5nKCkgKydtcyc7XHJcbiAgICAgIHRoaXMuaW1nMi5zdHlsZS53ZWJraXRUcmFuc2l0aW9uRHVyYXRpb24gPSB0aGlzLnRyYW5zaXRpb25UaW1lTVMudG9TdHJpbmcoKSArJ21zJztcclxuICAgICAgdGhpcy5pbWcxLmNsYXNzTGlzdC50b2dnbGUoJ25neC1pbWctY3Jvc3NmYWRlci10cmFuc3BhcmVudCcpO1xyXG4gICAgICB0aGlzLmltZzIuY2xhc3NMaXN0LnRvZ2dsZSgnbmd4LWltZy1jcm9zc2ZhZGVyLXRyYW5zcGFyZW50Jyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzdGVwQmFja3dhcmQoKSB7XHJcbiAgICBpZiAodGhpcy5pbWFnZVNvdXJjZXMubGVuZ3RoID4gMSkge1xyXG4gICAgICBpZiAodGhpcy5pbWcxLmNsYXNzTGlzdC5jb250YWlucygnbmd4LWltZy1jcm9zc2ZhZGVyLXRyYW5zcGFyZW50JykpIHtcclxuICAgICAgICB0aGlzLmltZzFOdW0gPSAodGhpcy5pbWcyTnVtIC0gMSArIHRoaXMuaW1hZ2VTb3VyY2VzLmxlbmd0aCkgJSB0aGlzLmltYWdlU291cmNlcy5sZW5ndGg7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5pbWcyTnVtID0gKHRoaXMuaW1nMU51bSAtIDEgICsgdGhpcy5pbWFnZVNvdXJjZXMubGVuZ3RoKSAlIHRoaXMuaW1hZ2VTb3VyY2VzLmxlbmd0aDtcclxuICAgICAgfSAgICAgIFxyXG4gICAgICB0aGlzLmltZzEuc3R5bGUudHJhbnNpdGlvbkR1cmF0aW9uID0gdGhpcy50cmFuc2l0aW9uVGltZU1TLnRvU3RyaW5nKCkgKydtcyc7XHJcbiAgICAgIHRoaXMuaW1nMS5zdHlsZS53ZWJraXRUcmFuc2l0aW9uRHVyYXRpb24gPSB0aGlzLnRyYW5zaXRpb25UaW1lTVMudG9TdHJpbmcoKSArJ21zJztcclxuICAgICAgdGhpcy5pbWcyLnN0eWxlLnRyYW5zaXRpb25EdXJhdGlvbiA9IHRoaXMudHJhbnNpdGlvblRpbWVNUy50b1N0cmluZygpICsnbXMnO1xyXG4gICAgICB0aGlzLmltZzIuc3R5bGUud2Via2l0VHJhbnNpdGlvbkR1cmF0aW9uID0gdGhpcy50cmFuc2l0aW9uVGltZU1TLnRvU3RyaW5nKCkgKydtcyc7XHJcbiAgICAgIHRoaXMuaW1nMS5jbGFzc0xpc3QudG9nZ2xlKCduZ3gtaW1nLWNyb3NzZmFkZXItdHJhbnNwYXJlbnQnKTtcclxuICAgICAgdGhpcy5pbWcyLmNsYXNzTGlzdC50b2dnbGUoJ25neC1pbWctY3Jvc3NmYWRlci10cmFuc3BhcmVudCcpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZ2V0U3JjKGltZ051bTogbnVtYmVyKTogc3RyaW5nIHtcclxuICAgIGlmIChpbWdOdW0gPCB0aGlzLmltYWdlU291cmNlcy5sZW5ndGgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuaW1hZ2VTb3VyY2VzW2ltZ051bV07XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBpZiAodGhpcy5pbWFnZVNvdXJjZXMubGVuZ3RoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaW1hZ2VTb3VyY2VzWzBdO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBnZXRJbWcxTnVtKCk6IG51bWJlciB7cmV0dXJuIHRoaXMuaW1nMU51bX1cclxuICBnZXRJbWcyTnVtKCk6IG51bWJlciB7cmV0dXJuIHRoaXMuaW1nMk51bX1cclxuXHJcbn1cclxuIl19